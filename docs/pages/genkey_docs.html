<!DOCTYPE html>
<html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <title>semi&#039;s site</title> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <link href="/css/bootstrap.min.css" rel="stylesheet" media="screen"> <link href="/css/custom.css" rel="stylesheet" media="screen"> <link rel="alternate" href="/rss.xml" type="application/rss+xml" /> 
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </head> <body> <div class="container-fluid"> <div class="row-fluid"> <div class="offset2 span8"> <div class="row-fluid"> <div class="navbar navbar-inverse"> <div class="navbar-inner"> <a class="brand" href="">semi&#039;s site</a> <ul class="nav"> <li> <a href="http://semilin.github.io/">Home</a> </li><li> <a href="http://github.com/semilin">Code</a> </li> </ul> </div> </div> </div> <div class="row-fluid"> <div class="row-fluid">
<h1 class="page-header">genkey docs</h1>
<p> Tagged as <a href="/tag/layouts.html">layouts</a>, <a href="/tag/software.html">software</a>, <a href="/tag/docs.html">docs</a>, <a href="/tag/math.html">math</a> </p> <p class="date-posted"> Written on 2023-01-01 23:18:45 </p> <!-- **** your post here (remove this line) **** -->

<!-- format: could be 'html' (for raw html) or 'md' (for markdown).  -->

<h1>Basic Usage</h1>

<p>Genkey is a command line tool. This means that you perform actions by
running the binary through the terminal.</p>

<p>The binary is called <code>genkey.exe</code> on Windows, or simply
<code>genkey</code> on Linux or MacOS. From now on, the binary will just
be referred to as <code>genkey</code>, so if you're using Windows, make
sure to correct it. Also note that you can autocomplete with TAB, in the
likely case that you don't want to type out the full name every time.</p>

<p>The general format of commands looks like this:</p>

<pre><code>./genkey COMMAND ARGUMENT</code></pre>

<h1>Layouts</h1>

<p>Layouts are stored as basic text files in the <code>layouts</code>
subdirectory. Here is an example of its format, using the unholy layout
as reference.</p>

<pre><code>QWERTY
q w e r t y u i o p [ ] 
a s d f g h j k l ; '
z x c v b n m , . /
0 1 2 3 3 4 4 5 6 7 7 7 7
0 1 2 3 3 4 4 5 6 7 7
0 1 2 3 3 4 4 5 6 7 
</code></pre>

<p>The first line is used as the name of the layout - the name of the file
is <strong>not</strong> used by the program. Note that if two files have the same
layout name, only one will show up; the program will output no error if
this happens, so make sure that you rename it!</p>

<p>The next block of lines is the layout itself. This is pretty much
self-explanatory. However, at the moment genkey only supports 3 rows,
adding more will confuse it.</p>

<p>The final block defines what finger is used to hit each key. Each
finger, not including thumbs, is a digit from 0 to 7. Left pinky is 0,
right pinky is 7, and everything in between follows the order you would
expect. Thumb keys are not supported in genkey, but <a href="https://github.com/apsu/genkey" >Apsu's
fork</a> does add experimental support.</p>

<h2>generate</h2>

<p>The <code>_generate</code> layout file is used to define the fingermap
for layouts created with the generate function. In addition, the main
key block can be used to pin keys for the improve function. Free keys
are labeled with <code>*</code>, and pinned keys are labeled with
<code>X</code>.</p>

<h1>Weighting</h1>

<p>The weights that determine how layouts are scored is configured in
<code>weights.hjson</code>. Though the base weights are made to be an
okay starting point, you are intended to experiment with them and shape
them to your liking.</p>

<p>The &quot;score&quot; is a very arbitrary number that should not be considered
an actual indicator of a layout's &quot;objective&quot; quality. The score is
calculated from the user's approximations of their personal
preferences. Anything that comes from personal preference can't be
objective, so do not treat it as such. Beating some layout's score is
great, but that doesn't mean it's actually better.</p>

<p>Note: higher score is worse, lower score is better.</p>

<h2>Distance</h2>

<p>This is the way to calculate distance between any two given keys on a
layout.</p>

<p>Where l is the lateral movement multiplier, the expression for
weighted distance is as follows:</p>

<p>$$ (l \times \Delta{x}^2) + (\Delta{y}^2) $$</p>

<p>This is the formula for distance, except not square rooted as to treat
distance exponentially.</p>

<h2>Finger Speed</h2>

<p>At a high level, finger speed is basically just looking at bigrams and
skipgrams with an adaptation of the rate equation:</p>

<p>$$ r=\frac{d}{n} $$</p>

<p>d is the distance between the two keys. n is the
'length' of the skip-gram, or how the distance between characters in
the sequence. For a bigram, n is 1. For a skip-1-gram, (e.g.
<code>t_e</code> in <code>the</code>) n is 2.</p>

<p>This equation effectively results in a time required to move a finger
from one key to another. Finger speed as a metric is the average of all
these times.</p>

<p>However, in reality there are more factors that affect this time.
Namely, different fingers differ greatly in how fast they can be moved.
Because of this, genkey has a KPS array, which defines how dexterous
each finger is. KPS stands for &quot;keys per second&quot;, which is what the
numbers were originally based on.</p>

<p>In addition, though it would theoretically work out that a skip-1-gram
has exactly twice the time to travel as a bigram, some people care about
skipgrams less than others. Because of this, genkey allows you to weight
it.<a href="dsfb" >^1</a></p>

<p>Also, a KeyTravel weight is provided, which can help avoid the problem
of double letters (e.g. <code>oo</code>) having 0 distance, and thus not being
counted at all. It's used as a baseline value for distance.</p>

<p>Considering these factors, the equation for a pair of keys ends up more
like the following (where k is key travel, F is the finger's
dexterity, and c is the count of how many times the pair appears):</p>

<p>$$ r=c \times \frac{(d+k)\times F}{n} $$</p>

<p>Genkey then gets the average time all of these same-finger pairs. The
lower that this metric is, the better. Though the original idea for this
was to be able to calculate how fast your fingers need to move to
maintain a given wpm, (hence the name) it is in reality much more
complicated than this. It's still a very useful metric, but take it
with a grain of salt.</p>

<h2>Index Balance</h2>

<p>This is a very simple metric that punishes one index finger being used
much more than the other. It's just the expression $$ |l-r| $$ where l
and r are left and right index usage respectively. Increasing the
weight increases its addition to the score.</p>

<h2>LSB</h2>

<p>LSB stands for Lateral Stretch Bigram. It refers to any adjacent finger
bigram where $$ \Delta x \ge 2 $$. This typically is used to mean bigrams
between index and middle fingers, but genkey also includes pinky and
ring in this calculation. More is worse, so increasing the weight value
increases how much it affects the score.</p>

<h2>Trigrams</h2>

<p>Genkey uses trigrams to calculate rolls, alternation, redirects, and
onehand rolls.</p>

<p>The TrigramPrecision value determines how many of the most common
trigrams are used for this calculation. Since there are far more
trigrams than SFBs, the calculation slows down generation a lot, so you
probably don't want to use all of them. However, if you do, you can set
the value to 0. Otherwise, setting the value to -1 disables the
calculation.</p>

<h3>Rolls</h3>

<p>Rolls are defined as 2 (not-same-finger) keys typed on one hand,
following or preceding 1 key pressed on the other. An inward roll is
where the direction of the 2 keys on the same hand approaches the index,
whereas an outward roll approaches the pinky. Since rolls are generally
desired, they subtract from the score.</p>

<h3>Alternation</h3>

<p>Alternates are defined as trigrams where each key in the sequence
switches hands. Since alternation is generally desired, it subtracts
from the score.</p>

<h3>Redirects</h3>

<p>Redirects are defined as trigrams where all keys are on the same hand,
but they do not all follow the same direction. For example,
<code>sfd</code> would be a redirect on QWERTY, because the direction of
<code>sf</code> is inward, but the direction of <code>fd</code> is
outward. Since redirects are generally undesired, they add to the score.</p>

<h3>Onehands</h3>

<p>Onehand rolls are defined as trigrams where all keys are on the same,
and they all follow the same direction. For example, <code>sdf</code> on
QWERTY would be a onehand roll. Since onehands are generally desired,
they subtract from the score.</p>

<h1>Commands</h1>

<h2>Load</h2>

<p>Usage: <code>./genkey load FILEPATH</code></p>

<p>This takes in a text file path, processes it as a corpus, and updates
<code>data.json</code> according to the text data that it collects. This
bigram and trigram frequency data is used for all other functions of the
program.</p>

<h2>Rank</h2>

<p>Usage: <code>./genkey r</code></p>

<p>Outputs a ranked list of layouts next to their scores.</p>

<h2>Analyze</h2>

<p>Usage: <code>./genkey a LAYOUT</code></p>

<p>Outputs detailed analysis of a layout.</p>

<h2>Generate</h2>

<p>Usage: <code>./genkey g</code></p>

<p>Generate simply creates a new layout, and tries to minimize score. How
long this takes varies, but calculating trigrams significantly increases
the time. Otherwise, how long it takes is probably most dependent on
your CPU's multicore efficiency.</p>

<h2>Improve</h2>

<p>Usage: <code>./genkey improve LAYOUT</code></p>

<p>Attempts to optimize the score of the given layout, without moving the
pinned keys (see [**<em>generate<em>]{.spurious-link target=&quot;</em></em>generate&quot;}).</p>

<h2>Interactive</h2>

<p>Usage: <code>./genkey i LAYOUT</code></p>

<p>The interactive mode is one of the more powerful parts of genkey. It
gives you tools to easily modify a layout and see the effects in
real-time. It's a fast and dynamic way to approach layout creation.</p>

<h3>Swap</h3>

<p>Usage: <code>s key1 key2</code></p>

<p>Swaps two letters with each other.</p>

<p>Example: <code>s a b</code></p>

<h3>Column Swap</h3>

<p>Usage: <code>cs key1 key2</code> or <code>cs col1 col2</code></p>

<p>Swaps two columns with each other. If you provide a key, then it targets
the column where that key is located. If you provide a number, it
targets the column corresponding to that number.</p>

<p>Examples:</p>

<ul>
<li><code>cs a b</code></li>
<li><code>cs 0 1</code></li>
</ul>

<h3>Suggest</h3>

<p>Usage: <code>g</code></p>

<p>Provides a suggestion of what two keys to swap. It does this with a
superficial neighbor search. It reports what score it will immediately
result in, and what score it can lead to.</p>

<h3>Save</h3>

<p>Usage: <code>save</code></p>

<p>Asks you for a layout name, and writes the file. If the name is already
taken, you'll be asked if you want to overwrite it.</p>

<h3>Quit</h3>

<p>Usage: <code>q</code></p>

<p>Is an explanation for this necessary</p>

<h1>Footnotes</h1>

<p>When semi came up with the finger speed concept, they coined the
    term &quot;disjointed bigram&quot;. Though a fancy sounding name, skipgram
    is an already existing term that fits better. Despite this, DSFB
    (&quot;disjointed same-finger bigram&quot;) is still used relatively
    frequently, which is why it's called that in genkey.</p>
 <ul class="pager"> 

</ul> </div>
 </div>  <div class="row-fluid"> <hr> <p class="fineprint">Unless otherwise credited all material <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US"> <img alt="Creative Commons License" style="border-width:0" src="/img/cc-by-sa.png" /> </a> by semi <a id="coleslaw-logo" href="https://github.com/redline6561/coleslaw"> <img src="/img/logo_small.jpg" alt="Coleslaw logo" /></p> </a> </div> </div> </div> </div> <script src="/js/bootstrap.min.js"></script> </body> </html>